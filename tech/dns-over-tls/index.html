<!doctype html><html lang=en_us prefix="og: https://ogp.me/ns#"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=darkreader-lock><title>DNS Over TLS to Prevent ISP From Blocking Websites - tifan.me</title><meta name=description content="Encrypt DNS queries for a more free internet ðŸ”“"><meta name=author content="Tifan Dwi Avianto"><meta property="og:title" content="DNS Over TLS to Prevent ISP From Blocking Websites"><meta property="og:description" content="Encrypt DNS queries for a more free internet ðŸ”“"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@tifandotme"><meta property="og:image" content="https://tifan.me/tech/dns-over-tls/browser.png"><meta property="og:url" content="https://tifan.me/tech/dns-over-tls/"><meta property="og:type" content="article"><meta property="og:site_name" content="tifan.me"><meta property="article:section" content="tech"><meta property="article:published_time" content="2022-11-14T20:38:38+07:00"><meta property="article:modified_time" content="2022-11-14T22:14:00+07:00"><link rel=stylesheet href=https://tifan.me/style.min.dd2bc8131ddcd0e728b486116d5614d948268ee08b2cf630846d924ef64d03ea.css type=text/css media=all><link rel=stylesheet href=https://tifan.me/syntax-highlighting.min.46dabb2f5d159e515f3501593dbdc1d89ac095a7b1b710b90795dbf13d30aa68.css type=text/css media=all><link rel=icon type=image/png href=/favicon.png><script data-host=https://microanalytics.io data-dnt=false src=https://microanalytics.io/js/script.js id=ZwSg9rf6GA async defer></script>
<script src=https://twemoji.maxcdn.com/v/latest/twemoji.min.js crossorigin=anonymous></script></head><body><nav class=back-nav><a href=/tech/><svg stroke="currentcolor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg><span>Tech</span></a></nav><article><header class=single><h1 class="bare fluid">DNS Over TLS to Prevent ISP From Blocking Websites</h1><h3 aria-hidden=true>Encrypt DNS queries for a more free internet ðŸ”“</h3><h4 aria-hidden=true>Published: Nov 14, 2022 / <span style=white-space:nowrap>Modified: Nov 14, 2022</span></h4><p><a href=https://tifan.me/tech/tags/linux/>#linux</a>&emsp;</p></header><h1 id=dns-over-tls>DNS Over TLS</h1><p>Definition from
<a href=https://www.cloudflare.com/learning/dns/dns-over-tls/ target=_blank>Cloudflare</a>:</p><blockquote><p>DNS over TLS, or DoT, is a standard for encrypting DNS queries to keep them secure and private. DoT uses the same security protocol, TLS, that HTTPS websites use to encrypt and authenticate communications. DoT adds TLS encryption on top of the user datagram protocol (UDP), which is used for DNS queries.</p></blockquote><h2 id=systemd-resolved>systemd-resolved</h2><p>If you are using Linux OSs with systemd, using this service will allow us to use DNS over TLS on our system.</p><p>Here&rsquo;s my config files for <code>/etc/systemd/resolved.conf</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>DNS<span style=color:#f92672>=</span>1.1.1.1#cloudflare-dns.com 1.0.0.1#cloudflare-dns.com 606:4700:4700::1111#cloudflare-dns.com 2606:4700:4700::1001#cloudflare-dns.com
</span></span><span style=display:flex><span>FallbackDNS<span style=color:#f92672>=</span>9.9.9.9#quad9.net 149.112.112.112#quad9.net 2620:fe::fe#quad9.net 2620:fe::9#quad9.net
</span></span><span style=display:flex><span>Domains<span style=color:#f92672>=</span>~.
</span></span><span style=display:flex><span>DNSSEC<span style=color:#f92672>=</span>yes
</span></span><span style=display:flex><span>DNSOverTLS<span style=color:#f92672>=</span>yes
</span></span></code></pre></div><blockquote><p>Personally I use cloudflare with quad9 as fallback. You can pick and choose how you want.</p></blockquote><p>To restart the services, run</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo systemctl restart systemd-resolved
</span></span><span style=display:flex><span>sudo systemctl restart NetworkManager
</span></span></code></pre></div><p>Check status</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>resolvectl status
</span></span></code></pre></div><p>Test connection at
<a href=https://1.1.1.1/help target=_blank>https://1.1.1.1/help</a></p><h1 id=dns-over-https>DNS over HTTPS</h1><p>Basically the difference is, instead of encrypting DNS queries directly over UDP, DoH encrypt from the HTTP or HTTP/2 protocol. Most major browsers actually have this feature built-in. On firefox:</p><figure><img src=browser.png alt="DNS over HTTP on browser"></figure><p>However, by using DNS over TLS with systemd-resolved, we are encrypting our DNS queries system-wide, rather than only the browser.</p><h1 id=references>References</h1><ul><li><a href=https://medium.com/@jawadalkassim/enable-dns-over-tls-in-linux-using-systemd-b03e44448c1c target=_blank>https://medium.com/@jawadalkassim/enable-dns-over-tls-in-linux-using-systemd-b03e44448c1c</a></li><li><a href=https://dns.sb/guide/dot/linux/#debian-and-most-popular-linux-distributions target=_blank>https://dns.sb/guide/dot/linux/#debian-and-most-popular-linux-distributions</a></li><li><a href=https://www.cloudflare.com/learning/dns/dns-over-tls/ target=_blank>https://www.cloudflare.com/learning/dns/dns-over-tls/</a></li></ul><section class=closing><span class=dot aria-hidden=true>â€¢</span>
<span>Comments? Please <a href="https://twitter.com/intent/tweet?screen_name=tifandotme&url=https://tifan.me/tech/dns-over-tls/" target=blank>tweet</a> or <a href='javascript:location=`mailto:\u0074\u0069\u0066\u0061\u006e\u0040\u0070\u0072\u006f\u0074\u006f\u006e\u002e\u006d\u0065?subject=Comment%20on:%20DNS%20Over%20TLS%20to%20Prevent%20ISP%20From%20Blocking%20Websites`;void 0'>email</a> me</span>
<span><a href=https://github.com/tifandotme/tifan.me/edit/main/content/tech/dns-over-tls/index.md target=blank>Edit post</a></span></section></article><footer><a href=https://tifan.me/>Home</a></footer></body><script>twemoji.parse(document.body)</script></html>